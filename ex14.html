
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Exercise 14: Querying MongoDB &mdash; Learn MongoDB And Node.js The Hard Way</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Learn MongoDB And Node.js The Hard Way" href="index.html" />
    <link rel="next" title="Exercise 15: Index This" href="ex15.html" />
    <link rel="prev" title="Exercise 13: Removing Documents" href="ex13.html" /> 
  </head>
  <body>
    <div class="related">
        <ul>
          <li class="right"><a style="color: #C40B46;" href="http://docs.mongodb.org/manual/" title="MongoDB Docs">MongoDB Docs</a></li>
          <li class="right"><a style="color: #C40B46;" href="http://mongodb.github.com/node-mongodb-native/" title="Driver Docs">Driver Docs</a> | </li>
        </ul>
    </div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="ex15.html" title="Exercise 15: Index This"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="ex13.html" title="Exercise 13: Removing Documents"
             accesskey="P">previous</a> |</li>
        <li><a href="http://ruby.learncodethehardway.org/">Learn MongoDB And Node.js The Hard Way</a> &raquo;</li> 
        <li class="right"><a href="search.html" title="search">search</a> | </li>
      </ul>
    </div>



    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="exercise-14-querying-mongodb">
<h1>Exercise 14: Querying MongoDB<a class="headerlink" href="#exercise-14-querying-mongodb" title="Permalink to this headline">¶</a></h1>
<p>To understand how queries work in <tt class="docutils literal"><span class="pre">MongoDB</span></tt> we need to understand how they work under the covers. When you execute a query against <tt class="docutils literal"><span class="pre">MongoDB</span></tt> it will create what is called a <tt class="docutils literal"><span class="pre">Cursor</span></tt> that is pointing to the results from the query. This is easier to show. Let's imagine that we perform a query asking for all cars that are owned by Steve. The might look like this.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">owner</span><span class="o">:</span> <span class="s1">&#39;Steve&#39;</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>There might be 1000 results for this query in the database as Steve is a very rich man indeed. To avoid sending all of the documents all at once to your application <tt class="docutils literal"><span class="pre">MongoDB</span></tt> decides to send only the first <tt class="docutils literal"><span class="pre">100</span></tt> cars. That leaves  <tt class="docutils literal"><span class="pre">900</span></tt> cars that we need to transfer. To be able to keep track of where in the 1000 cars we are for the next <tt class="docutils literal"><span class="pre">100</span></tt> we want to read <tt class="docutils literal"><span class="pre">MongoDB</span></tt> keeps a <tt class="docutils literal"><span class="pre">Cursor</span></tt> pointing to the current read location in the 1000 cars result. In this case the <tt class="docutils literal"><span class="pre">Cursor</span></tt> would point to <cite>100</cite>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="22%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Start</th>
<th class="head">End</th>
<th class="head">Cursor Position</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>100</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>100</td>
<td>200</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>200</td>
<td>300</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>.</td>
<td>.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>900</td>
<td>1000</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>After reading the first <tt class="docutils literal"><span class="pre">100</span></tt> cars the cursor position changes to point to the next <tt class="docutils literal"><span class="pre">100</span></tt> cars.</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="21%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Start</th>
<th class="head">End</th>
<th class="head">Cursor Position</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>100</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>100</td>
<td>200</td>
<td>X</td>
</tr>
<tr class="row-even"><td>200</td>
<td>300</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>.</td>
<td>.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>900</td>
<td>1000</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>We are only using <tt class="docutils literal"><span class="pre">100</span></tt> as an example your application could choose to read only 4 documents at the time as you can tell <tt class="docutils literal"><span class="pre">MongoDB</span></tt> how big you want each read to be. But more about that later. Once you finish reading the documents the <tt class="docutils literal"><span class="pre">Cursor</span></tt> is removed on <tt class="docutils literal"><span class="pre">MongoDB</span></tt>. There are some limitations on <tt class="docutils literal"><span class="pre">Cursors</span></tt>. You cannot go backwards in time only forward. In other words if you read the first <tt class="docutils literal"><span class="pre">100</span></tt> cars from the <tt class="docutils literal"><span class="pre">Cursor</span></tt> you cannot then reread the first <tt class="docutils literal"><span class="pre">100</span></tt> cars from the same cursor. You will have to execute a brand new query to do this.</p>
<p>The <tt class="docutils literal"><span class="pre">NodeJS</span></tt> driver represents the <tt class="docutils literal"><span class="pre">MongoDB</span></tt> cursor using a class called <tt class="docutils literal"><span class="pre">Cursor</span></tt> that we will explore in depth in later exercises. For this exercise we will explore the <tt class="docutils literal"><span class="pre">MongoDB</span></tt> query language using the simplest query function the driver has called <tt class="docutils literal"><span class="pre">findOne</span></tt> that returns the first document from a query.</p>
<div class="section" id="the-query-language">
<h2>The Query Language<a class="headerlink" href="#the-query-language" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">MongoDB</span></tt> query language features several different operators. These include Comparison, Logical, Element, JavaScript, Geospatial and Array operators. In this exercise we will cover the Comparison, Logical, Element, JavaScript and Array operator. We will leave Geospatial ones to a later exercise.</p>
<p>So lets start with the Comparison operators.</p>
</div>
<div class="section" id="comparison-operators">
<h2>Comparison operators<a class="headerlink" href="#comparison-operators" title="Permalink to this headline">¶</a></h2>
<p>The comparison operators let's you compare documents to values to select the ones you wish to be returned. There are several operators available including <tt class="docutils literal"><span class="pre">$all</span></tt>, <tt class="docutils literal"><span class="pre">$gt</span></tt>, <tt class="docutils literal"><span class="pre">$gte</span></tt>, <tt class="docutils literal"><span class="pre">$in</span></tt>, <tt class="docutils literal"><span class="pre">$lt</span></tt>, <tt class="docutils literal"><span class="pre">$lte</span></tt>, <tt class="docutils literal"><span class="pre">$ne</span></tt> and <tt class="docutils literal"><span class="pre">$nin</span></tt>. Let's go through them and see how they work (we only look at how the matching works).</p>
</div>
<div class="section" id="all-contains-all">
<h2>$all (Contains all)<a class="headerlink" href="#all-contains-all" title="Permalink to this headline">¶</a></h2>
<p>Say you have a set of documents containing some tags.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Now image that you want to locate all the documents that contain the tags <tt class="docutils literal"><span class="pre">&quot;game&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;scifi&quot;</span></tt> and <tt class="docutils literal"><span class="pre">&quot;pc&quot;</span></tt>. This is where the <tt class="docutils literal"><span class="pre">$all</span></tt> operator comes in. Our query would look like this.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">tags</span><span class="o">:</span> <span class="p">{</span><span class="nx">$all</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">]}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span> <span class="p">]</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="gt-greater-than">
<h2>$gt (Greater Than)<a class="headerlink" href="#gt-greater-than" title="Permalink to this headline">¶</a></h2>
<p>Say you have some user documents containing the field age.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">67</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">28</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>You wish to query for the users that are older than 30 years. Let's use the <tt class="docutils literal"><span class="pre">$gt</span></tt> or <tt class="docutils literal"><span class="pre">Greater</span> <span class="pre">Than</span></tt> operator. The query would look like this.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gt</span><span class="o">:</span> <span class="mi">28</span><span class="p">}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">67</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="gte-greater-than-or-equal">
<h2>$gte (Greater Than or Equal)<a class="headerlink" href="#gte-greater-than-or-equal" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">$gte</span></tt> or <tt class="docutils literal"><span class="pre">Greater</span> <span class="pre">than</span> <span class="pre">or</span> <span class="pre">Equal</span></tt> is similar to <tt class="docutils literal"><span class="pre">$gt</span></tt> but includes any documents that match the value provided as well as any values larger than the provided value. Given the following documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">67</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">28</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the documents where the age is greater or equal to <tt class="docutils literal"><span class="pre">28</span></tt>.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gte</span><span class="o">:</span> <span class="mi">28</span><span class="p">}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">67</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">28</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="in-contains-one-of">
<h2>$in (Contains One Of)<a class="headerlink" href="#in-contains-one-of" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$in</span></tt> operator lets us match any document where a value is in a predefined set of values. Let's take a set of documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;xbox1080&quot;</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;pc&quot;</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the games that are available for the <tt class="docutils literal"><span class="pre">xbox1080</span></tt> and the <tt class="docutils literal"><span class="pre">ps2000</span></tt>.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">platform</span><span class="o">:</span> <span class="p">{</span><span class="nx">$in</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;ps2000&quot;</span><span class="p">,</span> <span class="s2">&quot;xbox1080&quot;</span><span class="p">]}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span><span class="p">,</span> <span class="s2">&quot;platform&quot;</span> <span class="o">:</span> <span class="s2">&quot;xbox1080&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span><span class="p">,</span> <span class="s2">&quot;platform&quot;</span> <span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="lt-less-than">
<h2>$lt (Less Than)<a class="headerlink" href="#lt-less-than" title="Permalink to this headline">¶</a></h2>
<p>Say you have some user documents containing the field age.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">67</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">28</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>We wish to select all the users where the age is less than 28.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lt</span><span class="o">:</span> <span class="mi">28</span><span class="p">}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">25</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="lte-less-than-or-equal">
<h2>$lte (Less Than or Equal)<a class="headerlink" href="#lte-less-than-or-equal" title="Permalink to this headline">¶</a></h2>
<p>Just as with <tt class="docutils literal"><span class="pre">$gte</span></tt>, <tt class="docutils literal"><span class="pre">$lte</span></tt> is a Less than or equal operator letting you find all documents where the specified field is less or equal to the provided value. Let's see it in action.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">67</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span>
  <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">28</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>We wish to select all the users where the age is less than 28.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lte</span><span class="o">:</span> <span class="mi">28</span><span class="p">}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">25</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">28</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="ne-not-equal-to">
<h2>$ne (Not Equal To)<a class="headerlink" href="#ne-not-equal-to" title="Permalink to this headline">¶</a></h2>
<p>Imagine if we wish to find all documents that does not specify a specific value. Let's take an example set of documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span>
  <span class="p">,</span> <span class="nx">agent</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span>
  <span class="p">,</span> <span class="nx">agent</span><span class="o">:</span> <span class="kc">false</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>We wish to select all the users who are not agents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">agent</span><span class="o">:</span> <span class="p">{</span><span class="nx">$ne</span><span class="o">:</span> <span class="kc">true</span><span class="p">}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span><span class="p">,</span> <span class="s2">&quot;agent&quot;</span> <span class="o">:</span> <span class="kc">false</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Take not that <tt class="docutils literal"><span class="pre">$ne</span></tt> matches not only on the document that has <tt class="docutils literal"><span class="pre">agent:false</span></tt> but also the document that does not contain the <tt class="docutils literal"><span class="pre">agent</span></tt> field.</p>
</div>
<div class="section" id="nin-contains-none-of">
<h2>$nin (Contains None Of)<a class="headerlink" href="#nin-contains-none-of" title="Permalink to this headline">¶</a></h2>
<p>Think of <tt class="docutils literal"><span class="pre">$nin</span></tt> as a reverse off the <tt class="docutils literal"><span class="pre">$in</span></tt> operator. Let's define a set of documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the games that do not contain the <tt class="docutils literal"><span class="pre">pc</span></tt> tag.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">tags</span><span class="o">:</span><span class="p">{</span><span class="nx">$nin</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;pc&quot;</span><span class="p">]}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In a later exercise we will learn about something called indexes that speed up queries. <tt class="docutils literal"><span class="pre">$nin</span></tt> is poison for search on very big collections because <tt class="docutils literal"><span class="pre">$nin</span></tt> queries cannot use an index and needs to scan through all of the document individually. The best is to rewrite you code to avoid <tt class="docutils literal"><span class="pre">$nin</span></tt> or only use it in very small collections where the cost of scanning through all of the documents is very low.</p>
</div>
<p>That covers all the comparison expressions for <tt class="docutils literal"><span class="pre">MongoDB</span></tt>. Next let's see how we can combine them with <tt class="docutils literal"><span class="pre">Logical</span></tt> operators to make create more advanced queries.</p>
</div>
<div class="section" id="logical-operators">
<h2>Logical operators<a class="headerlink" href="#logical-operators" title="Permalink to this headline">¶</a></h2>
<p>So what if you want to query for an age range (between 10 and 20 years) or return only documents where the age is 20 and the location is Barcelona. This is where the logical operators come in. There are four of them in <tt class="docutils literal"><span class="pre">MongoDB</span></tt>. They are <tt class="docutils literal"><span class="pre">$and</span></tt>, <tt class="docutils literal"><span class="pre">$or</span></tt>, <tt class="docutils literal"><span class="pre">$not</span></tt> and <tt class="docutils literal"><span class="pre">$or</span></tt>. Let's look at them in turn.</p>
</div>
<div class="section" id="and">
<h2>$and<a class="headerlink" href="#and" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$and</span></tt> operator allows to ask questions like find me all users aged 28 and living in New York. Only documents matching both of them will be returned. Let's look at a simple example.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre>  <span class="p">[{</span>
      <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
    <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span>
    <span class="p">,</span> <span class="nx">location</span><span class="o">:</span> <span class="s2">&quot;NYC&quot;</span>
    <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">67</span>
  <span class="p">},{</span>
      <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
    <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span>
    <span class="p">,</span> <span class="nx">location</span><span class="o">:</span> <span class="s2">&quot;NYC&quot;</span>
    <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span>
  <span class="p">},{</span>
      <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
    <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span>
    <span class="p">,</span> <span class="nx">location</span><span class="o">:</span> <span class="s2">&quot;NYC&quot;</span>
    <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">28</span>
  <span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>We wish to select all the users where the age is less than 28.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">$and</span><span class="o">:</span> <span class="p">[{</span><span class="nx">age</span><span class="o">:</span> <span class="mi">28</span><span class="p">},</span> <span class="p">{</span><span class="nx">location</span><span class="o">:</span> <span class="s2">&quot;NYC&quot;</span><span class="p">}]}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span> <span class="o">:</span> <span class="s2">&quot;NYC&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">28</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Let's look at how we can combine the logical operator with a comparison operator to select a range. More specifically all the users living in NYC between and including the ages of 28 and 70.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">$and</span><span class="o">:</span> <span class="p">[{</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gte</span><span class="o">:</span> <span class="mi">28</span><span class="p">}},</span> <span class="p">{</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$lte</span><span class="o">:</span> <span class="mi">70</span><span class="p">}},</span> <span class="p">{</span><span class="nx">location</span><span class="o">:</span> <span class="s2">&quot;NYC&quot;</span><span class="p">}]}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span> <span class="o">:</span> <span class="s2">&quot;NYC&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">67</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span> <span class="o">:</span> <span class="s2">&quot;NYC&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">28</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>One thing we need to mention is that the <tt class="docutils literal"><span class="pre">$and</span></tt> operator can be expressed in a different way. Let's look how. Take the same query as above.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">age</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gte</span><span class="o">:</span> <span class="mi">28</span><span class="p">,</span> <span class="nx">$lte</span><span class="o">:</span> <span class="mi">70</span><span class="p">},</span> <span class="nx">location</span><span class="o">:</span> <span class="s2">&quot;NYC&quot;</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span> <span class="o">:</span> <span class="s2">&quot;NYC&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">67</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span> <span class="o">:</span> <span class="s2">&quot;NYC&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">28</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Let's look at what just happened. Take <tt class="docutils literal"><span class="pre">age:</span> <span class="pre">{$gte:</span> <span class="pre">28,</span> <span class="pre">$lte:</span> <span class="pre">70}</span></tt> the comma between the <tt class="docutils literal"><span class="pre">$gte</span></tt> and <tt class="docutils literal"><span class="pre">$lte</span></tt> is an implicit <tt class="docutils literal"><span class="pre">$and</span></tt> meaning this is a short form for the same expression as above using the <tt class="docutils literal"><span class="pre">$and</span></tt>. So for short you can use the comma as an <tt class="docutils literal"><span class="pre">$and</span></tt>.</p>
</div>
<div class="section" id="or">
<h2>$or<a class="headerlink" href="#or" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$or</span></tt> or logical OR let's you ask questions such as return all games where the platform is <tt class="docutils literal"><span class="pre">pc</span></tt> or one of the tags is <tt class="docutils literal"><span class="pre">&quot;pc&quot;</span></tt>. To be selected a document has to satisfy at least one of the <tt class="docutils literal"><span class="pre">$or</span></tt> statements.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;steam&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;pc&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the games that do not contain the <tt class="docutils literal"><span class="pre">pc</span></tt> tag.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span><span class="nx">$or</span><span class="o">:</span> <span class="p">[{</span><span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;pc&quot;</span><span class="p">},</span> <span class="p">{</span><span class="nx">tags</span><span class="o">:</span> <span class="p">{</span><span class="nx">$in</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;pc&quot;</span><span class="p">]}}]}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span><span class="p">,</span> <span class="s2">&quot;platform&quot;</span> <span class="o">:</span> <span class="s2">&quot;steam&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span> <span class="p">]</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span><span class="p">,</span> <span class="s2">&quot;platform&quot;</span> <span class="o">:</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to each <tt class="docutils literal"><span class="pre">$or</span></tt> statement actually being checked in parallel by <tt class="docutils literal"><span class="pre">MongoDB</span></tt> they cannot share what is called a compound index (more on this later). To speed up this query we need to create two different indexes. One for the field tags and one for the field platform.</p>
</div>
</div>
<div class="section" id="not">
<h2>$not<a class="headerlink" href="#not" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$not</span></tt> or logical NOT let's you ask questions such as, show me all users that are not older than 28. Take the following documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre>  <span class="p">[{</span>
      <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
    <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Agent Smith&quot;</span>
    <span class="p">,</span> <span class="nx">location</span><span class="o">:</span> <span class="s2">&quot;NYC&quot;</span>
    <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">67</span>
  <span class="p">},{</span>
      <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
    <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Mr Anderson&quot;</span>
    <span class="p">,</span> <span class="nx">location</span><span class="o">:</span> <span class="s2">&quot;NYC&quot;</span>
    <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">25</span>
  <span class="p">},{</span>
      <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
    <span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span>
    <span class="p">,</span> <span class="nx">location</span><span class="o">:</span> <span class="s2">&quot;NYC&quot;</span>
    <span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">28</span>
  <span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>We wish to select all the users where the age is not greater than 28 and less than 26.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="nx">age</span><span class="o">:</span> <span class="p">{</span> <span class="nx">$not</span><span class="o">:</span> <span class="p">{</span> <span class="nx">$gt</span><span class="o">:</span> <span class="mi">28</span><span class="p">,</span> <span class="nx">$lt</span><span class="o">:</span> <span class="mi">26</span><span class="p">}}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Trinity&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span> <span class="o">:</span> <span class="s2">&quot;NYC&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span> <span class="o">:</span> <span class="mi">28</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>In most cases a <tt class="docutils literal"><span class="pre">$not</span></tt> operator can be considered a reversal of a query and can be useful to quickly find what is not covered by a given query.</p>
</div>
<div class="section" id="nor">
<h2>$nor<a class="headerlink" href="#nor" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$nor</span></tt> or logical NOR is way to locate documents that do not satisfy an expression. Given a set of documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;steam&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;pc&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the games that do not have the tag <tt class="docutils literal"><span class="pre">pc</span></tt> nor the tag <tt class="docutils literal"><span class="pre">10+</span></tt>.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="nx">$nor</span><span class="o">:</span> <span class="p">[{</span><span class="nx">tags</span><span class="o">:</span> <span class="s2">&quot;pc&quot;</span><span class="p">},</span> <span class="p">{</span><span class="nx">tags</span><span class="o">:</span> <span class="s2">&quot;10+&quot;</span><span class="p">}]}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span><span class="p">,</span> <span class="s2">&quot;platform&quot;</span> <span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Take care when using negations in queries where you rely on indexes as negations can sometime make it impossible for <tt class="docutils literal"><span class="pre">MongoDB</span></tt> to use an index forcing it to scan the entire collection for matching documents. In a later exercise we will learn all there is to know about indexes in <tt class="docutils literal"><span class="pre">MongoDB</span></tt> and how to ensure your queries uses them efficiently.</p>
</div>
<p>This covers the Logical operators the <tt class="docutils literal"><span class="pre">MongoDB</span></tt> query language supports. Next up is element level operators.</p>
</div>
<div class="section" id="element-operators">
<h2>Element operators<a class="headerlink" href="#element-operators" title="Permalink to this headline">¶</a></h2>
<p>The element operators <tt class="docutils literal"><span class="pre">$exists</span></tt>, <tt class="docutils literal"><span class="pre">$mod</span></tt> and <tt class="docutils literal"><span class="pre">$type</span></tt> let you match on if a field exists, a specific module remainder or if the field is of a specific BSON type.</p>
</div>
<div class="section" id="exists">
<h2>$exists<a class="headerlink" href="#exists" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$exists</span></tt> operator lets us select documents based on if a field exists or not instead of by a specific value. Given the documents below.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;steam&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span>
  <span class="p">,</span> <span class="nx">sale</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;pc&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the games that are for sale (in this case has the field sale).</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="nx">sale</span><span class="o">:</span> <span class="p">{</span><span class="nx">$exists</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span><span class="p">,</span> <span class="s2">&quot;platform&quot;</span> <span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span><span class="p">,</span> <span class="s2">&quot;sale&quot;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="mod">
<h2>$mod<a class="headerlink" href="#mod" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$mod</span></tt> operator let's us match documents based on the remainder of dividing to numbers. We have two simple examples below.</p>
<div class="highlight-console"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="go">8 / 8    = 1</span>
<span class="go">8 mod 8  = 0</span>

<span class="go">8 / 9    = 0.88888888</span>
<span class="go">8 mod 9  = 0</span>

<span class="go">16 / 8   = 2</span>
<span class="go">16 mod 8 = 0</span>
</pre></div>
</td></tr></table></div>
<p>As you can see the <tt class="docutils literal"><span class="pre">remainder</span></tt> of the <tt class="docutils literal"><span class="pre">8</span> <span class="pre">/</span> <span class="pre">9</span></tt> division is <tt class="docutils literal"><span class="pre">8</span></tt> as it cannot be divided to a whole number. The module only show the remainder of the division. Let's look at an example that's a bit contrived but still demonstrates the usage of the <tt class="docutils literal"><span class="pre">$mod</span></tt> operator.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;steam&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">12</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">24</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;pc&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">27</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all games that have a price that's a multiple of 12.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="nx">price</span><span class="o">:</span> <span class="p">{</span><span class="nx">$mod</span><span class="o">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span><span class="p">,</span> <span class="s2">&quot;platform&quot;</span> <span class="o">:</span> <span class="s2">&quot;steam&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span> <span class="o">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span> <span class="p">]</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span><span class="p">,</span> <span class="s2">&quot;platform&quot;</span> <span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span> <span class="o">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">$mod</span></tt> operator cannot use an index so it will force <tt class="docutils literal"><span class="pre">MongoDB</span></tt> to scan through all of your documents potentially causing slow queries if the collection contains a lot of documents.</p>
</div>
</div>
<div class="section" id="type">
<h2>$type<a class="headerlink" href="#type" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$type</span></tt> operator let's us select documents based on what kind of BSON type it is. The BSON types are defined in the following table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="46%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Number</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Double</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>String</td>
<td>2</td>
</tr>
<tr class="row-even"><td>Object</td>
<td>3</td>
</tr>
<tr class="row-odd"><td>Array</td>
<td>4</td>
</tr>
<tr class="row-even"><td>Binary data</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>Object id</td>
<td>7</td>
</tr>
<tr class="row-even"><td>Boolean</td>
<td>8</td>
</tr>
<tr class="row-odd"><td>Date</td>
<td>9</td>
</tr>
<tr class="row-even"><td>Null</td>
<td>10</td>
</tr>
<tr class="row-odd"><td>Regular Expression</td>
<td>11</td>
</tr>
<tr class="row-even"><td>JavaScript</td>
<td>13</td>
</tr>
<tr class="row-odd"><td>Symbol</td>
<td>14</td>
</tr>
<tr class="row-even"><td>JavaScript w/scope</td>
<td>15</td>
</tr>
<tr class="row-odd"><td>32 bit integer</td>
<td>16</td>
</tr>
<tr class="row-even"><td>Timestamp</td>
<td>17</td>
</tr>
<tr class="row-odd"><td>64 bit integer</td>
<td>18</td>
</tr>
<tr class="row-even"><td>Min key</td>
<td>-1</td>
</tr>
<tr class="row-odd"><td>Max key</td>
<td>127</td>
</tr>
</tbody>
</table>
<p>Let's look at example using the following documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">12</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">24</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="s2">&quot;27&quot;</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the documents where the file is a numeric type.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="nx">$or</span><span class="o">:</span> <span class="p">[</span> <span class="p">{</span><span class="nx">price</span><span class="o">:</span> <span class="p">{</span><span class="nx">$type</span><span class="o">:</span> <span class="mi">16</span><span class="p">}},</span> <span class="p">{</span><span class="nx">price</span><span class="o">:</span> <span class="p">{</span><span class="nx">$type</span><span class="o">:</span> <span class="mi">18</span><span class="p">}},</span> <span class="p">{</span><span class="nx">price</span><span class="o">:</span> <span class="p">{</span><span class="nx">$type</span><span class="o">:</span> <span class="mi">1</span><span class="p">}}]}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span> <span class="o">:</span> <span class="mi">12</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span> <span class="o">:</span> <span class="mi">24</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Since <tt class="docutils literal"><span class="pre">MongoDB</span></tt> allows a field to have any the <tt class="docutils literal"><span class="pre">$type</span></tt> operator can be very useful to detect if you have documents that use a different field type than the one expected.</p>
</div>
<div class="section" id="javascript-operators">
<h2>JavaScript operators<a class="headerlink" href="#javascript-operators" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">MongoDB</span></tt> query language also supports the use of JavaScript in queries in the form of the <tt class="docutils literal"><span class="pre">$regexp</span></tt> and <tt class="docutils literal"><span class="pre">$where</span></tt> operators. However its prudent to warn against using <tt class="docutils literal"><span class="pre">$where</span></tt> in your queries as it will run the comparison over all of the documents in the collection as well as in the <tt class="docutils literal"><span class="pre">MongoDB</span></tt> JavaScript runtime meaning performance leaves a lot to be desired.</p>
</div>
<div class="section" id="regexp-regular-expressions">
<h2>$regexp (Regular expressions)<a class="headerlink" href="#regexp-regular-expressions" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$regexp</span></tt> operator lets you perform string matches using the  (<a class="reference external" href="http://www.pcre.org/">http://www.pcre.org/</a>). The <tt class="docutils literal"><span class="pre">MongoDB</span></tt> query language supports the following options.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>i</td>
<td>allows case insensitive matches</td>
</tr>
<tr class="row-odd"><td>m</td>
<td>will match across multiple lines (otherwise stops at the first line)</td>
</tr>
<tr class="row-even"><td>x</td>
<td>ignores all white space in the text</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>allows dot character to match all characters</td>
</tr>
</tbody>
</table>
<p>Let's look at example using the following documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">12</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">24</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="s2">&quot;27&quot;</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the documents starting with Wing.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="nx">title</span><span class="o">:</span> <span class="sr">/^Wing/</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span> <span class="o">:</span> <span class="mi">12</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">One of the problems with the <tt class="docutils literal"><span class="pre">$regexp</span></tt> operator is that it needs to search through all of the documents in a collection do locate matches for most cases. The only case where it will use an index (and thus execute more rapidly) is if the regular expression is performing a case sensitive match from the start of the string such as <tt class="docutils literal"><span class="pre">/^Wing</span></tt>.</p>
</div>
</div>
<div class="section" id="where">
<h2>$where<a class="headerlink" href="#where" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$where</span></tt> operator lets you match documents using JavaScript expression. However it comes with a massive <tt class="docutils literal"><span class="pre">Here</span> <span class="pre">lies</span> <span class="pre">dragons</span></tt> warning sign as it needs to scan the entire collection to match documents (using no indexes) and runs inside the <tt class="docutils literal"><span class="pre">MongoDB</span></tt> JavaScript engine meaning it impacts the performance of the server and is fairly slow. Use with extreme caution. Give the dire warning let's look at an example. Given the following documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;steam&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">12</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;ps2000&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">24</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">platform</span><span class="o">:</span> <span class="s2">&quot;pc&quot;</span>
  <span class="p">,</span> <span class="nx">price</span><span class="o">:</span> <span class="mi">27</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span><span class="p">,</span> <span class="s2">&quot;steam&quot;</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the documents where the number of tags is more than four.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="nx">$where</span><span class="o">:</span> <span class="s2">&quot;this.tags.length &gt; 4&quot;</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span><span class="p">,</span> <span class="s2">&quot;platform&quot;</span> <span class="o">:</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span> <span class="o">:</span> <span class="mi">27</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span><span class="p">,</span> <span class="s2">&quot;steam&quot;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As mentioned before use extreme caution when using <tt class="docutils literal"><span class="pre">$where</span></tt> as it will impact your application performance.</p>
</div>
</div>
<div class="section" id="array-operators">
<h2>Array Operators<a class="headerlink" href="#array-operators" title="Permalink to this headline">¶</a></h2>
<p>The last set of query operators we will cover in this exercise is the Array operator <tt class="docutils literal"><span class="pre">$size</span></tt>.</p>
</div>
<div class="section" id="size">
<h2>$size<a class="headerlink" href="#size" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">$size</span></tt> operator let's us match on the size of an array. Take the following documents.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">[{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span><span class="p">]</span>
<span class="p">},{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="mi">3</span>
  <span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Star Controller 2&quot;</span>
  <span class="p">,</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;10+&quot;</span><span class="p">,</span> <span class="s2">&quot;steam&quot;</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</td></tr></table></div>
<p>Let's select all the documents where the number of tags is four.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="nx">tags</span><span class="o">:</span> <span class="p">{</span><span class="nx">$size</span><span class="o">:</span><span class="mi">4</span><span class="p">}}</span>
</pre></div>
</td></tr></table></div>
<p>The results returned are.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Wing Commander 72&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">,</span> <span class="s2">&quot;13+&quot;</span> <span class="p">]</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span> <span class="o">:</span> <span class="s2">&quot;Dead space 15&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="s2">&quot;scifi&quot;</span><span class="p">,</span> <span class="s2">&quot;mac&quot;</span><span class="p">,</span> <span class="s2">&quot;18+&quot;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>This covers the query operators in <tt class="docutils literal"><span class="pre">MongoDB</span></tt> that we wanted to cover in this exercise. We have intentionally skipped <tt class="docutils literal"><span class="pre">Geospatial</span></tt> query operators as well as <tt class="docutils literal"><span class="pre">Projection</span></tt> operators as we will introduce them in later exercises.</p>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
        <ul>
          <li class="right"><a style="color: #C40B46;" href="http://docs.mongodb.org/manual/" title="MongoDB Docs">MongoDB Docs</a></li>
          <li class="right"><a style="color: #C40B46;" href="http://mongodb.github.com/node-mongodb-native/" title="Driver Docs">Driver Docs</a> | </li>
        </ul>
    </div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="ex15.html" title="Exercise 15: Index This"
             >next</a></li>
        <li class="right" >
          <a href="ex13.html" title="Exercise 13: Removing Documents"
             >previous</a> |</li>
        <li><a href="http://ruby.learncodethehardway.org/">Learn MongoDB And Node.js The Hard Way</a> &raquo;</li> 
        <li class="right"><a href="search.html" title="search">search</a> | </li>
      </ul>
    </div>
    <a name="comments"><hr/></a>

<div sytle="text-align: left">
    <div style="background: white; padding: 10px" id="disqus_thread"></div>
</div>
    <script type="text/javascript">
        var dow = new Date().getDay();

        if(dow == 5 || dow == 6) {
            $("#disqus_thread").html("<h1>Today Is Christians's Day Off</h1><p>I take Saturday and Sunday off.  Comments open again on Monday-Friday.</p>")
        } else {
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'learnmongodbthehardway'; // required: replace example with your forum shortname


            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        }
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <div class="footer">
      &copy; Copyright 2012, Christian Amor Kvalheim.
      Last updated on Jan 31, 2013.
</div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24168052-9']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </body>
</html>